{"version":3,"sources":["../../../dist-esnext/prods/app/productApp.js"],"names":["V","createApp","productAppArgs","productRepository","saveProduct","updateProduct","findProducts","find","deleteProduct","seed","curry","func","args","productArgs","createdBy","authedUser","product","isValid","Promise","resolve","productDb","getById","id","save","query","limit","options","products","allProducts","map"],"mappings":";;;;;;;AAAA;;IAAYA,C;;AACZ;;AACA;;;;;;;;;;AACO,MAAMC,gCAAaC,cAAD,IAAoB;AACzC,UAAMC,oBAAoBD,eAAeC,iBAAzC;AACA,WAAO;AACHC,qBAAaA,YAAY;AACrBD,6BADqB;AAErBE;AAFqB,SAAZ,CADV;AAKHC,sBAAcA,aAAaH,kBAAkBI,IAA/B,CALX;AAMHC,qBANG;AAOHC;AAPG,KAAP;AASH,CAXM;AAYA,MAAML,oCAAc,gBAAEM,KAAF;AAAA,iCAAQ,WAAOC,IAAP,EAAaC,IAAb,EAAsB;AACrDA,aAAKC,WAAL,CAAiBC,SAAjB,GAA6BF,KAAKG,UAAlC;AACA,YAAIC,UAAU,2BAAcJ,KAAKC,WAAnB,CAAd;AACA,YAAI,CAACb,EAAEiB,OAAF,CAAUD,OAAV,CAAL,EACI,OAAOE,QAAQC,OAAR,CAAgBH,OAAhB,CAAP;AACJ,cAAMI,YAAY,MAAMT,KAAKR,iBAAL,CAAuBkB,OAAvB,CAA+BL,QAAQM,EAAvC,CAAxB;AACA,YAAIF,SAAJ,EACIJ,UAAUL,KAAKN,aAAL,CAAmBe,SAAnB,EAA8BJ,OAA9B,CAAV;AACJA,kBAAU,MAAML,KAAKR,iBAAL,CAAuBoB,IAAvB,CAA4BP,OAA5B,CAAhB;AACA,eAAOE,QAAQC,OAAR,CAAgBH,OAAhB,CAAP;AACH,KAV0B;;AAAA;AAAA;AAAA;AAAA,KAApB;AAWP;AACO,MAAMV,sCAAe,gBAAEI,KAAF;AAAA,kCAAQ,WAAOH,IAAP,EAAaK,IAAb;AAAA,eAAsBL,KAAKK,KAAKY,KAAV,EAAiB,EAAEC,OAAOb,KAAKc,OAAL,CAAaD,KAAtB,EAAjB,CAAtB;AAAA,KAAR;;AAAA;AAAA;AAAA;AAAA,KAArB;AACA,MAAMhB,sBAAO,gBAAEC,KAAF,CAAQ,CAACP,iBAAD,EAAoBY,UAApB,KAAmC;AAC3D,UAAMY,WAAW,iBAAeC,WAAhC;AACAD,aAASE,GAAT;AAAA,sCAAa,WAAOb,OAAP;AAAA,mBAAmB,MAAMZ,YAAY,EAAED,iBAAF,EAAZ,EAAmC,EAAEU,aAAaG,OAAf,EAAwBD,UAAxB,EAAnC,CAAzB;AAAA,SAAb;;AAAA;AAAA;AAAA;AAAA;AACA,WAAOG,QAAQC,OAAR,CAAgB,IAAhB,CAAP;AACH,CAJmB,CAAb;AAKA,MAAMX,wCAAiBI,IAAD,IAAU;AACnC,WAAOM,QAAQC,OAAR,CAAgB,KAAhB,CAAP;AACH,CAFM;AAGP","file":"productApp.js","sourcesContent":["import * as V from 'ptz-validations';\r\nimport { createProduct, products as productsToSeed, updateProduct as updateProductFunc } from '../domain';\r\nimport R from 'ramda';\r\nexport const createApp = (productAppArgs) => {\r\n    const productRepository = productAppArgs.productRepository;\r\n    return {\r\n        saveProduct: saveProduct({\r\n            productRepository,\r\n            updateProduct: updateProductFunc,\r\n        }),\r\n        findProducts: findProducts(productRepository.find),\r\n        deleteProduct,\r\n        seed\r\n    };\r\n};\r\nexport const saveProduct = R.curry(async (func, args) => {\r\n    args.productArgs.createdBy = args.authedUser;\r\n    var product = createProduct(args.productArgs);\r\n    if (!V.isValid(product))\r\n        return Promise.resolve(product);\r\n    const productDb = await func.productRepository.getById(product.id);\r\n    if (productDb)\r\n        product = func.updateProduct(productDb, product);\r\n    product = await func.productRepository.save(product);\r\n    return Promise.resolve(product);\r\n});\r\n// tslint:disable-next-line:max-line-length\r\nexport const findProducts = R.curry(async (find, args) => find(args.query, { limit: args.options.limit }));\r\nexport const seed = R.curry((productRepository, authedUser) => {\r\n    const products = productsToSeed.allProducts;\r\n    products.map(async (product) => await saveProduct({ productRepository }, { productArgs: product, authedUser }));\r\n    return Promise.resolve(true);\r\n});\r\nexport const deleteProduct = (args) => {\r\n    return Promise.resolve(false);\r\n};\r\n//# sourceMappingURL=productApp.js.map"]}