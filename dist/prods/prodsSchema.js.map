{"version":3,"sources":["../../dist-esnext/prods/prodsSchema.js"],"names":["ProdsSchema","productApp","authedUser","log","prodsType","name","fields","_id","type","price","category","prodsConnection","nodeType","getProds","connectionType","args","resolve","_","ctx","findProducts","query","options","limit","first","createdBy","getSaveProdMutation","inputFields","id","prodName","email","displayName","password","errors","outputFields","prodEdge","edgeType","prod","node","cursor","mutateAndGetPayload","productArgs","param2","param3","saveProduct","savedProduct"],"mappings":";;;;;;AAAA;;AACA;;;;AACA,SAASA,WAAT,OAAsD;AAAA,QAA/BC,UAA+B,QAA/BA,UAA+B;AAAA,QAAnBC,UAAmB,QAAnBA,UAAmB;AAAA,QAAPC,GAAO,QAAPA,GAAO;;AAClD,QAAMC,YAAY,+BAAsB;AACpCC,cAAM,OAD8B;AAEpCC,gBAAQ;AAAA,mBAAO;AACXC,qBAAK,EAAEC,4BAAF,EADM;AAEXH,sBAAM,EAAEG,4BAAF,EAFK;AAGXC,uBAAO,EAAED,2BAAF,EAHI;AAIXE,0BAAU,EAAEF,4BAAF;AAJC,aAAP;AAAA;AAF4B,KAAtB,CAAlB;AASA,QAAMG,kBAAkB,yCAAsB;AAC1CN,cAAM,OADoC;AAE1CO,kBAAUR;AAFgC,KAAtB,CAAxB;AAIA,aAASS,QAAT,GAAoB;AAChB,eAAO;AACHL,kBAAMG,gBAAgBG,cADnB;AAEHC,8CAFG;AAGHC,qBAAS,iBAACC,CAAD,EAAIF,IAAJ,EAAUG,GAAV,EAAkB;AACvBf,oBAAI,eAAJ;AACA,uBAAO,+CAA4BF,WAAWkB,YAAX,CAAwB;AACvDC,2BAAO,EADgD;AAEvDC,6BAAS,EAAEC,OAAOP,KAAKQ,KAAd,EAF8C;AAGvDrB,gCAAYgB,IAAIM;AAHuC,iBAAxB,CAA5B,EAIHT,IAJG,CAAP;AAKH;AAVE,SAAP;AAYH;AACD,aAASU,mBAAT,GAA+B;AAAA;;AAC3B,eAAO,gDAA6B;AAChCpB,kBAAM,UAD0B;AAEhCqB,yBAAa;AACTC,oBAAI,EAAEnB,4BAAF,EADK;AAEToB,0BAAU,EAAEpB,MAAM,mDAAR,EAFD;AAGTqB,uBAAO,EAAErB,MAAM,mDAAR,EAHE;AAITsB,6BAAa,EAAEtB,MAAM,mDAAR,EAJJ;AAKTuB,0BAAU,EAAEvB,MAAM,mDAAR,EALD;AAMTwB,wBAAQ,EAAExB,MAAM,gDAAR;AANC,aAFmB;AAUhCyB,0BAAc;AACVC,0BAAU;AACN1B,0BAAMG,gBAAgBwB,QADhB;AAENnB,6BAAS,iBAACoB,IAAD,EAAU;AACfjC,4BAAI,SAAJ,EAAeiC,IAAf;AACA,+BAAO,EAAEC,MAAMD,IAAR,EAAcE,QAAQF,KAAKT,EAA3B,EAAP;AACH;AALK;AADA,aAVkB;AAmBhCY;AAAA,oFAAqB,iBAAOC,WAAP,EAAoBC,MAApB,EAA4BC,MAA5B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAEbvC,wCAAI,cAAJ,EAAoBqC,WAApB;AACArC,wCAAI,gBAAJ,EAAsBsC,MAAtB;AACAtC,wCAAI,gBAAJ,EAAsBuC,MAAtB;AAJa;AAAA,2CAKczC,WAAW0C,WAAX,CAAuB;AAC9CH,gEAD8C;AAE9CtC,oDAAY;AAFkC,qCAAvB,CALd;;AAAA;AAKP0C,gDALO;;AASbzC,wCAAI,gBAAJ,EAAsByC,YAAtB;AATa,qEAUNA,YAVM;;AAAA;AAAA;AAAA;;AAabzC,wCAAI,oBAAJ;;AAba;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAArB;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAnBgC,SAA7B,CAAP;AAoCH;AACD,WAAO;AACHU,0BADG;AAEHY;AAFG,KAAP;AAIH;kBACczB,W;AACf","file":"prodsSchema.js","sourcesContent":["import { GraphQLFloat, GraphQLList, GraphQLNonNull, GraphQLObjectType, GraphQLString } from 'graphql';\r\nimport { connectionArgs, connectionDefinitions, connectionFromPromisedArray, mutationWithClientMutationId } from 'graphql-relay';\r\nfunction ProdsSchema({ productApp, authedUser, log }) {\r\n    const prodsType = new GraphQLObjectType({\r\n        name: 'Prods',\r\n        fields: () => ({\r\n            _id: { type: GraphQLString },\r\n            name: { type: GraphQLString },\r\n            price: { type: GraphQLFloat },\r\n            category: { type: GraphQLString }\r\n        })\r\n    });\r\n    const prodsConnection = connectionDefinitions({\r\n        name: 'Prods',\r\n        nodeType: prodsType\r\n    });\r\n    function getProds() {\r\n        return {\r\n            type: prodsConnection.connectionType,\r\n            args: connectionArgs,\r\n            resolve: (_, args, ctx) => {\r\n                log('getting prods');\r\n                return connectionFromPromisedArray(productApp.findProducts({\r\n                    query: {},\r\n                    options: { limit: args.first },\r\n                    authedUser: ctx.createdBy\r\n                }), args);\r\n            }\r\n        };\r\n    }\r\n    function getSaveProdMutation() {\r\n        return mutationWithClientMutationId({\r\n            name: 'SaveProd',\r\n            inputFields: {\r\n                id: { type: GraphQLString },\r\n                prodName: { type: new GraphQLNonNull(GraphQLString) },\r\n                email: { type: new GraphQLNonNull(GraphQLString) },\r\n                displayName: { type: new GraphQLNonNull(GraphQLString) },\r\n                password: { type: new GraphQLNonNull(GraphQLString) },\r\n                errors: { type: new GraphQLList(GraphQLString) }\r\n            },\r\n            outputFields: {\r\n                prodEdge: {\r\n                    type: prodsConnection.edgeType,\r\n                    resolve: (prod) => {\r\n                        log('ql prod', prod);\r\n                        return { node: prod, cursor: prod.id };\r\n                    }\r\n                }\r\n            },\r\n            mutateAndGetPayload: async (productArgs, param2, param3) => {\r\n                try {\r\n                    log('saving prod:', productArgs);\r\n                    log('saving param2:', param2);\r\n                    log('saving param3:', param3);\r\n                    const savedProduct = await productApp.saveProduct({\r\n                        productArgs,\r\n                        authedUser: null\r\n                    });\r\n                    log('saved product:', savedProduct);\r\n                    return savedProduct;\r\n                }\r\n                catch (e) {\r\n                    log('Error saving prod:', e);\r\n                }\r\n            }\r\n        });\r\n    }\r\n    return {\r\n        getProds,\r\n        getSaveProdMutation\r\n    };\r\n}\r\nexport default ProdsSchema;\r\n//# sourceMappingURL=prodsSchema.js.map"]}